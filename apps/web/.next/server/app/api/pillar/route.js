"use strict";(()=>{var e={};e.id=6522,e.ids=[6522],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},21820:e=>{e.exports=require("os")},28354:e=>{e.exports=require("util")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73929:(e,r,t)=>{t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>d,serverHooks:()=>x,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{GET:()=>u,POST:()=>l});var a=t(31453),i=t(91306),n=t(71817),p=t(56492),o=t(3998);async function u(e){try{let r;let{searchParams:t}=new URL(e.url),s=t.get("department_id");return r=s?await o.prisma.pillars.findMany({where:{department_id:Number(s)},include:{department:{select:{dept_id:!0,dept_name:!0}},assigned_kpi:{select:{assigned_kpi_id:!0,kpi_name:!0,kpi_status:!0}}}}):await o.prisma.pillars.findMany({include:{department:{select:{dept_id:!0,dept_name:!0}},_count:{select:{assigned_kpi:!0}}}}),p.NextResponse.json({success:!0,pillars:r})}catch(e){return console.error("Error fetching pillars:",e),p.NextResponse.json({success:!1,error:"Failed to fetch pillars"},{status:500})}}async function l(e){try{let{pillar_name:r,department_id:t}=await e.json();if(!r)return p.NextResponse.json({success:!1,error:"Pillar name is required"},{status:400});if(!t)return p.NextResponse.json({success:!1,error:"Department ID is required"},{status:400});if(!await o.prisma.departments.findUnique({where:{dept_id:Number(t)}}))return p.NextResponse.json({success:!1,error:"Department not found"},{status:404});if(await o.prisma.pillars.findFirst({where:{pillar_name:r,department_id:Number(t)}}))return p.NextResponse.json({success:!1,error:"A pillar with this name already exists in this department"},{status:400});let s=await o.prisma.pillars.create({data:{pillar_name:r,department_id:Number(t)}});return p.NextResponse.json({success:!0,message:"Pillar created successfully",pillar:s})}catch(e){return console.error("Error creating pillar:",e),p.NextResponse.json({success:!1,error:"Failed to create pillar"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/pillar/route",pathname:"/api/pillar",filename:"route",bundlePath:"app/api/pillar/route"},resolvedPagePath:"/Users/vverma/ERP/ERP-SYS/apps/web/app/api/pillar/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:m,serverHooks:x}=d;function f(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:m})}},79646:e=>{e.exports=require("child_process")},79748:e=>{e.exports=require("fs/promises")},83997:e=>{e.exports=require("tty")},84297:e=>{e.exports=require("async_hooks")},94735:e=>{e.exports=require("events")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[3747,3332,2302],()=>t(73929));module.exports=s})();